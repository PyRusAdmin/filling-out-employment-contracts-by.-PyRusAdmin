<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/static/styles.css"> <!-- –°—Ç–∏–ª—å –ø—Ä–æ–µ–∫—Ç–∞ -->
</head>
<body>
<div class="app-container">
    <header>
        <h1>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è</h1>
    </header>

    <div class="grid-container">
        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-file-excel"></i></div>
            <div class="feature-title">–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel</div>
            <div class="feature-description">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</div>
            <button class="action-button" onclick="handleAction(1)">–û–±—Ä–∞–±–æ—Ç–∞—Ç—å Excel</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-exchange-alt"></i></div>
            <div class="feature-title">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</div>
            <div class="feature-description">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ —ç–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel</div>
            <button class="action-button" onclick="handleAction(3)">–°—Ä–∞–≤–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-database"></i></div>
            <div class="feature-title" style="color: red;">–ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</div>
            <div class="feature-description" style="color: red;">–ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö</div>
            <button class="action-button" onclick="location.href='/import_excel_form'">–†–∞–±–æ—Ç–∞ —Å –ë–î</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-file-signature"></i></div>
            <div class="feature-title">–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</div>
            <div class="feature-description">–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä—É–¥–æ–≤–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞</div>
            <button class="action-button" onclick="handleAction(5)">–ü–æ–ª—É—á–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-broom"></i></div>
            <div class="feature-title">–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</div>
            <div class="feature-description">–£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</div>
            <button class="action-button" onclick="handleAction(7)">–û—á–∏—Å—Ç–∏—Ç—å –ë–î</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-file-alt"></i></div>
            <div class="feature-title">–î–æ–ø. —Å–æ–≥–ª–∞—à–µ–Ω–∏—è</div>
            <div class="feature-description">–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–≥–ª–∞—à–µ–Ω–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä–∞–º</div>
            <button class="action-button" onclick="handleAction(8)">–°–æ–∑–¥–∞—Ç—å —Å–æ–≥–ª–∞—à–µ–Ω–∏—è</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-file-contract"></i></div>
            <div class="feature-title">–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤</div>
            <div class="feature-description">–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç—Ä—É–¥–æ–≤—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–≥–ª–∞—à–µ–Ω–∏–π</div>
            <button class="action-button" onclick="handleAction(12)">–ü–µ—Ä–µ–π—Ç–∏</button>
        </div>

        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-file-contract"></i></div>
            <div class="feature-title">–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
            <div class="feature-description">–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è</div>
            <button class="action-button" onclick="handleAction(13)">–ü–µ—Ä–µ–π—Ç–∏</button>
        </div>

        <!-- –°–≤–µ—Ä–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å JSON -->
        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-file-excel"></i></div>
            <div class="feature-title">–°–≤–µ—Ä–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
            <div class="feature-description">–£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ missing.txt</div>
            <button class="action-button" onclick="handleAction(17)">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
        </div>


        <!-- –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É -->
        <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-power-off"></i></div>
            <div class="feature-title">–í—ã—Ö–æ–¥</div>
            <div class="feature-description">–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
            <button class="action-button" onclick="handleAction(6)">–í—ã–π—Ç–∏</button>
        </div>

    </div>

    <footer>
        ¬© 2024 –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
    </footer>
</div>

<script>
async function handleAction(action) {
    if (action === 17) {
        try {
            const formData = new FormData();
            formData.append("user_input", "17");

            const response = await fetch("/action", {
                method: "POST",
                body: formData
            });

            const result = await response.json();

            if (Number(result.missing_count) > 0) {
                alert(`‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ ${result.missing_count} –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π!`);

                if (result.download_url) {
                    const link = document.createElement("a");
                    link.href = result.download_url;
                    link.download = "missing.txt";
                    document.body.appendChild(link);
                    link.click();
                    link.remove();
                }
            } else {
                alert("üéâ –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ –º–µ—Å—Ç–µ!");
            }
        } catch (err) {
            alert("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π");
            console.error(err);
        }
    }
}
</script>

<script src="/static/script.js"></script> <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
</body>
</html>